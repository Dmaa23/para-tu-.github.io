<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pistola de Corazones</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            height: 100vh;
            position: relative;
            overflow: hidden;
            background: radial-gradient(circle at top center, #2a1a3f 0%, #1a0a2f 50%, #0a0015 100%);
            background-attachment: fixed;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #pistol {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%) scale(0.6);
            transform-origin: left center;
            width: 240px;
            height: 140px;
            display: none;
        }
        .cabin {
            width: 80px;
            height: 120px;
            position: absolute;
            top: 10px;
            left: 0;
            border: 5px double #d70024;
            background: linear-gradient(to bottom, #3C2F2F, #1A1A1A);
            box-shadow: 0 6px 14px rgba(255, 215, 0, 0.4);
            border-radius: 12px;
            overflow: hidden;
            display: block;
        }
        .cabin-window {
            width: 60px;
            height: 80px;
            position: absolute;
            top: 35px;
            left: 10px;
            background-size: 90% auto;
            background-repeat: no-repeat;
            background-position: center top;
            border-radius: 5px;
        }
        .cabin-cover {
            width: 60px;
            height: 20px;
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: linear-gradient(to bottom, #3C2F2F, #1A1A1A);
            border: 2px solid #ff0062;
        }
        .barrel, .handle, .base, .trigger, .magazine {
            display: none;
        }
        .heart-piece {
            position: absolute;
            font-size: 30px;
            transform: scale(0.9);
            transition: left 0.8s ease-out, top 0.8s ease-out, transform 0.8s ease-out, opacity 0.8s ease-out;
            color: #ff69b4;
            opacity: 0;
            filter: drop-shadow(0 0 5px #ff0000) drop-shadow(0 0 10px #ff1493);
            animation: float-heart 2s ease-in-out infinite;
        }
        .heart-piece.visible {
            opacity: 1;
        }
        @keyframes float-heart {
            0%, 100% {
                transform: translateY(0) scale(0.6);
            }
            50% {
                transform: translateY(-5px) scale(0.7);
            }
        }
        #target-image {
            position: absolute;
            width: 150px;
            height: 150px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            animation: float 2s ease-in-out infinite;
            transition: opacity 0.3s ease;
            border: none;
            background-color: transparent;
            display: none;
        }
        #new-image {
            position: absolute;
            width: 150px;
            height: 150px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            border: none;
            background-color: transparent;
            animation: float 2s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }
        .explosion {
            position: absolute;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255,255,255,1), rgba(255,255,255,0.8), rgba(255,255,255,0));
            pointer-events: none;
            box-shadow: 0 0 30px 15px rgba(255,255,255,0.7);
            transform: translate(-50%, -50%);
        }
        @keyframes flashAnim {
            0% {
                transform: translate(-50%, -50%) scale(0.5);
                opacity: 0;
            }
            20% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
            80% {
                transform: translate(-50%, -50%) scale(1.2);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(1.5);
                opacity: 0;
            }
        }
        .message {
            position: absolute;
            font-size: 24px;
            font-family: 'Roboto', sans-serif;
            font-weight: 700;
            color: #ff69b4;
            text-shadow: 0 0 10px #ff1493, 0 0 20px #ff69b4, 0 0 30px #ff0000;
            opacity: 0;
            transition: opacity 1s ease, transform 1s ease;
            transform: translate(-50%, 20px);
            text-align: center;
        }
        .message.visible {
            opacity: 1;
            transform: translate(-50%, 0);
        }
        .input-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 400px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border-radius: 20px;
            z-index: 1000;
            backdrop-filter: blur(5px);
            padding: 20px;
            text-align: center;
            font-family: 'Roboto', sans-serif;
        }
        .input-panel header {
            padding: 15px;
            background: linear-gradient(45deg, #ff0057, #ff4e7a);
            color: white;
            font-size: 1.5em;
            border-top-left-radius: 20px;
            border-top-right-radius: 20px;
        }
        .input-panel p {
            color: #333;
            font-size: 1.2em;
            margin: 15px 0;
            font-family: 'Roboto', sans-serif;
        }
        .input-panel input {
            width: calc(100% - 24px);
            padding: 12px;
            margin: 10px 0;
            border-radius: 12px;
            border: none;
            background: #f0f0f0;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.1);
            font-size: 1em;
        }
        .input-panel input:focus {
            outline: none;
            box-shadow: 0 0 8px rgba(255, 0, 87, 0.5);
        }
        .input-panel button {
            padding: 12px 24px;
            font-size: 16px;
            font-family: 'Roboto', sans-serif;
            font-weight: 700;
            cursor: pointer;
            background: linear-gradient(45deg, #ff0057, #ff4e7a);
            color: white;
            border: none;
            border-radius: 8px;
            transition: background 0.3s ease, transform 0.3s ease;
        }
        .input-panel button:hover {
            background: linear-gradient(45deg, #e0004d, #e83765);
            transform: scale(1.05);
        }
        .timer {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.95);
            padding: 10px 15px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            font-size: 0.9em;
            color: #333;
            font-family: 'Arial', sans-serif;
            z-index: 1000;
            display: none;
        }
        .timer span {
            color: #ff0057;
            font-weight: bold;
        }
        #button, #restart {
            position: absolute;
            padding: 12px 24px;
            font-size: 16px;
            font-family: 'Roboto', sans-serif;
            font-weight: 700;
            cursor: pointer;
            background: linear-gradient(to bottom, #800000, #4B0000);
            color: white;
            border: 2px solid #1e0147;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(255, 215, 0, 0.3);
            transition: background 0.3s ease, transform 0.3s ease, opacity 0.5s ease;
            display: none;
        }
        #button:hover, #restart:hover {
            background: linear-gradient(to bottom, #A00000, #600000);
            transform: scale(1.05);
        }
        #button {
            left: 0;
            top: calc(50% + 90px);
        }
        #final-image {
    display: none;
    position: absolute;
    top: 20%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: auto;
    height: auto;
    max-width: 500px;
    max-height: 500px;
    transition: opacity 1s ease-in;
    opacity: 0;
    border-radius: 20px;
        }
        #carta-container {
            display: none;
            position: absolute;
            top: 70%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(255, 255, 255, 0.9);
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            text-align: left;
            font-family: 'Roboto', sans-serif;
            font-size: 0.9em;
            color: #000000;
            text-shadow: 1px 1px 2px #000000;
            opacity: 0;
            transition: opacity 1s ease-in;
            max-width: 80%;
            width: 600px;
            max-height: 60vh;
            overflow-y: auto;
            border: 2px solid #ff0057;
            background-image: url('https://raw.githubusercontent.com/jesuxzx/Im-genes-/main/papel.png');
            background-size: cover;
        }
        #carta-texto {
            white-space: pre-wrap;
            overflow: hidden;
            border-right: .05em solid #ff69b4;
            animation: blink-caret .7s step-end infinite alternate;
        }
       @keyframes blink-caret {
        50% { border-color: transparent; }
        }
        @keyframes blink-caret {
            50% { border-color: transparent }
        }
        @media (max-width: 600px) {
            .input-panel {
                width: 95%;
            }
            .timer {
                font-size: 0.8em;
                padding: 8px 12px;
            }
            #carta-container {
                font-size: 1.2em;
                padding: 20px;
                width: 90%;
                max-height: 70vh;
            }
            @keyframes typing {
                from { width: 0 }
                to { width: 100% }
            }
        }
    </style>
</head>
<body>
    <div class="input-panel" id="inputPanel">
        <header>Con Todo Mi Amor 💗</header>
        <p>Te amo 💗</p>
        <input type="text" id="usuarioInput" placeholder=" Te amo mi amo 💗">
        <button onclick="verificarUsuario()">Entrar</button>
    </div>
    <div id="pistol">
        <div class="cabin">
            <div class="cabin-window"></div>
            <div class="cabin-cover"></div>
        </div>
        <div class="barrel">
            <div class="barrel-tip"></div>
        </div>
        <div class="handle"></div>
        <div class="base"></div>
        <div class="trigger"></div>
        <div class="magazine">
            <div class="magazine-fill"></div>
        </div>
    </div>
    <div id="target-image"></div>
    <button id="button" onclick="startShooting()">Encender</button>
    <img id="final-image" src="https://raw.githubusercontent.com/jesuxzx/Im-genes-/main/bears-with-kisses-bg.gif">
    <div id="carta-container">
        <p id="carta-texto"></p>
    </div>
    <script>
        let nombreUsuario = '';
        const imagenUrl = 'https://raw.githubusercontent.com/jesuxzx/Im-genes-/main/bears-with-kisses-bg.gif';
        const totalShots = 58;
        let shotCount = 0;
        let isShooting = false;
        const heartPieces = [];
        const positions = [
            { x: 0, y: -1.0 }, { x: 0.3, y: -1.2 }, { x: 0.6, y: -1.3 },
            { x: 0.9, y: -1.25 }, { x: 1.2, y: -1.1 }, { x: 1.4, y: -0.9 },
            { x: 1.55, y: -0.6 }, { x: 1.6, y: -0.3 }, { x: 1.55, y: 0.0 },
            { x: 1.4, y: 0.3 }, { x: 1.2, y: 0.55 }, { x: 0.9, y: 0.8 },
            { x: 0.6, y: 1.0 }, { x: 0.3, y: 1.15 }, { x: 0.0, y: 1.3 },
            { x: -0.3, y: 1.15 }, { x: -0.6, y: 1.0 }, { x: -0.9, y: 0.8 },
            { x: -1.2, y: 0.55 }, { x: -1.4, y: 0.3 }, { x: -1.55, y: 0.0 }, { x: -1.6, y: -0.3 },
            { x: -1.55, y: -0.6 }, { x: -1.4, y: -0.9 }, { x: -1.2, y: -1.1 }, { x: -0.9, y: -1.25 },
            { x: -0.6, y: -1.3 }, { x: -0.3, y: -1.2 }, { x: 0, y: -1.0 }
        ];
        const cartaCompleta = `Mi bebe linda 💗
        
Cada día a tu lado, aunque sea lejos, me siento inmensamente feliz. Tu presencia ilumina mi vida de una manera que nunca imaginé. Te amo profundamente, más de lo que las palabras pueden expresar. Eres mi alegría, mi inspiración y mi todo.
        
tus ojos Son los ojos más hermosos que he conocido, llenos de un brillo que me enamora cada vez que los veo, aunque sea a través de una pantalla.
Contando los días para tenerte cerca mi bebe, te amo con todo mi corazón 💗 siempre estaré para ti no importa el dia o la hora❤️

Con todo mi amor, Tu negrito 💗`;
        let indiceCarta = 0;
        const velocidadEscritura = 100;
        const cartaTextoElement = document.getElementById('carta-texto');

        // La función para escribir la carta carácter por carácter
        function escribirCarta() {
            if (indiceCarta < cartaCompleta.length) {
                cartaTextoElement.textContent += cartaCompleta.charAt(indiceCarta);
                indiceCarta++;
                setTimeout(escribirCarta, velocidadEscritura);
            }
        }

        function verificarUsuario() {
            const usuario = document.getElementById('usuarioInput').value.trim().toLowerCase();
            if (usuario !== 'te amo mas'.toLowerCase()) {
                alert("❌ Contraseña incorrecta.");
                return;
            }
            nombreUsuario = 'Mi amor 💗';
            const targetImage = document.getElementById('target-image');
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            targetImage.style.left = `${centerX - 75}px`;
            targetImage.style.top = `${centerY - 100}px`;
            targetImage.style.backgroundImage = `url('img/2.png')`;
            targetImage.style.display = 'block';
            document.getElementById('inputPanel').style.display = 'none';
            document.getElementById('pistol').style.display = 'block';
            document.getElementById('button').style.display = 'block';
        }
        async function startShooting() {
            if (isShooting) return;
            isShooting = true;
            const button = document.getElementById('button');
            button.style.opacity = '0';
            setTimeout(() => { button.style.display = 'none'; }, 500);
            const cabinWindow = document.querySelector('.cabin-window');
            cabinWindow.style.backgroundImage = "url('https://raw.githubusercontent.com/jesuxzx/Im-genes-/14f60f59b9a536e21520bb2bba8b8be1371879bf/dudu-pew-dudu-gun.gif')";
            document.querySelectorAll('.explosion, .message, #new-image').forEach(el => el.remove());
            heartPieces.forEach(el => el.remove());
            heartPieces.length = 0;
            const heartSize = 80;
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            const cabin = document.querySelector('.cabin');
            shotCount = 0;
            for (let i = 0; i < positions.length; i++) {
                const heartTargetX = centerX + positions[i].x * heartSize;
                const heartTargetY = centerY + positions[i].y * heartSize;
                let emoji = document.createElement('div');
                emoji.classList.add('heart-piece');
                emoji.innerHTML = '❤️';
                emoji.style.left = `${cabin.getBoundingClientRect().right}px`;
                emoji.style.top = `${cabin.getBoundingClientRect().top + cabin.getBoundingClientRect().height / 2}px`;
                document.body.appendChild(emoji);
                emoji.offsetHeight;
                heartPieces.push(emoji);
                emoji.classList.add('visible');
                emoji.style.left = `${heartTargetX}px`;
                emoji.style.top = `${heartTargetY}px`;
                emoji.style.transform = 'scale(1.0)';
                shotCount++;
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            await new Promise(resolve => setTimeout(resolve, 1000));
            await shootTarget();
            heartPieces.forEach(el => el.remove());
            heartPieces.length = 0;
            isShooting = false;
        }
        async function shootTarget() {
            const targetImage = document.getElementById('target-image');
            const targetRect = targetImage.getBoundingClientRect();
            const cabin = document.querySelector('.cabin');
            const cabinWindow = document.querySelector('.cabin-window');
            const targetX = targetRect.left + targetRect.width / 2;
            const targetY = targetRect.top + targetRect.height / 2;
            await new Promise(resolve => setTimeout(resolve, 500));
            let firstShot = document.createElement('div');
            firstShot.classList.add('heart-piece');
            firstShot.innerHTML = '❤️';
            firstShot.style.fontSize = '24px';
            firstShot.style.left = `${cabin.getBoundingClientRect().right}px`;
            firstShot.style.top = `${cabin.getBoundingClientRect().top + cabin.getBoundingClientRect().height / 2}px`;
            document.body.appendChild(firstShot);
            firstShot.offsetHeight;
            heartPieces.push(firstShot);
            firstShot.classList.add('visible');
            firstShot.style.left = `${targetX}px`;
            firstShot.style.top = `${targetY}px`;
            firstShot.style.transform = 'scale(1.5)';
            shotCount++;
            await new Promise(resolve => {
                firstShot.addEventListener('transitionend', () => {
                    let flash = document.createElement('div');
                    flash.classList.add('explosion');
                    flash.style.left = `${targetX}px`;
                    flash.style.top = `${targetY}px`;
                    flash.style.animation = 'flashAnim 1s ease-in-out';
                    document.body.appendChild(flash);
                    targetImage.style.opacity = '0';
                    firstShot.style.opacity = '0';
                    flash.addEventListener('animationend', () => {
                        flash.remove();
                        cabin.style.display = 'none';
                        cabinWindow.style.backgroundImage = '';
                        const finalImageElement = document.getElementById('final-image');
                        const cartaElement = document.getElementById('carta-container');
                        if (finalImageElement) {
                            finalImageElement.style.display = 'block';
                            finalImageElement.style.opacity = '1';
                        }
                        if (cartaElement) {
                            cartaElement.style.display = 'block';
                            setTimeout(() => {
                                cartaElement.style.opacity = '1';
                                escribirCarta(); // Aquí se llama la función de escritura gradual
                            }, 100);
                        }
                        resolve();
                    });
                });
            });
   }
    </script>
</body>
</html>
